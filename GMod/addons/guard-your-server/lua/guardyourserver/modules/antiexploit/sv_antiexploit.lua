--[[
    CREDITS:
    Atlas Uprising
]]
if not GYS.AntiExploit then return end

--[[
    Timer: Simple
    This after 5 seconds searchs and fakes 11 exploits.
]]
timer.Simple(
    5,
    function()
        for _, v in pairs(GYS.BadNets) do
            if util.NetworkStringToID(v) ~= 0 then
                GYS.Log("Backdoor Found - " .. v .. " [YOUR SERVER MAY BE AT RISK]")
                net.Receive(
                    v,
                    function(_, ply)
                        hook.Run("GYS.Detection", ply, "Anti-Exploit")
                        GYS.Ban(ply, 0, "GYS: Exploiting", "Exploiting")
                    end
                )
                GYS.Log("We tried closing off backdoor " .. v .. ".")
            end
        end
        local a = 0
        local curnet = {}
        local fakenet
        repeat
            fakenet = table.Random(GYS.BadNets)
            if curnet[fakenet] then return end
            util.AddNetworkString(fakenet)
            net.Receive(fakenet, function(_, ply)
                hook.Run("GYS.Detection", ply, "Anti-Exploit")
                GYS.Ban(ply, 0, "GYS: Exploiting", "Exploiting")
            end)
            table.insert(curnet, fakenet)
            GYS.Log("Setup " .. fakenet .. " for fake exploit.")
            a = a + 1
        until a > 11
    end
)
GYS.Log("AntiExploit Loaded")